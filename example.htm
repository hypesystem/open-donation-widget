<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Example | open-donation-wiget</title>
        <style type="text/css">
            body {
                text-align: center;
                margin: 0;
            }
            .open-donation.donation-box {
                margin: 40px;
                display: inline-block;
                padding: 30px 50px;
                width: 400px;
                text-align: left;
                border: 3px solid grey;
            }
            .open-donation.donation-row {
                padding: 20px 0;
            }
            .open-donation.button-row {
                text-align: center;
                padding: 10px 0 0 0;
            }
        </style>
    </head>
    <body>
        <div class="open-donation donation-box">
            <form class="open-donation donation-form">
                <div class="open-donation donation-row donation-form-row">
                    <div class="open-donation number-input-wrapper">
                        <input type="number" placeholder="0.00" name="open-donation-amount" class="open-donation donation-input">
                    </div>
                    <div class="open-donation monetary-transparency-explainer">
                        
                    </div>
                </div>
                <div class="open-donation button-row donation-form-row">
                    <button class="open-donation submit-button">Donate</button>
                </div>
            </form>
        </div>
        <script src="./MoneyHandler.js"></script>
        <script>
            var moneyHandlers = [
                new MoneyHandler("Payments Provider", 5, 0.25),
                new MoneyHandler("Platform", 1, 0),
                new MoneyHandler("Creator")
            ];
            var inputBox = document.querySelectorAll(".open-donation.donation-input")[0];
            function updateMonetaryTransparency() {
                var amount = inputBox.value;
                var rest = amount;
                var strings = [];
                moneyHandlers.forEach(function(moneyHandler) {
                    var earnings = moneyHandler.getEarnings(amount, rest);
                    rest = rest - earnings;
                    strings.push(earnings + "$ (" + moneyHandler.toString() + ") -> " + moneyHandler.getName());
                });
                console.log("rest is", rest);
                var explainerBox = document.querySelectorAll(".open-donation.monetary-transparency-explainer")[0];
                explainerBox.innerHTML = "";
                strings.forEach(function(str) {
                    explainerBox.innerHTML += "<div>" + str + "</div>";
                });
            }
            inputBox.addEventListener("input", function(e) {
                updateMonetaryTransparency();
            });
            updateMonetaryTransparency();
        </script>
    </body>
</html>